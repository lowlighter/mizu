<main *set="{ coins: 0, income: 1, built: ['ğŸª'], build: { selected: 0, progress: 0, time: 0 } }" *mustache>
  <div class="flash accent">
    You have {{ coins }} ğŸª™<br />
    Last refresh: <time class="muted" *refresh="1" *text="new Date().toISOString().slice(11, 19)" *eval="$refresh && (coins += income)"></time>
  </div>
  <form *set="{ buildings: ['Choose a building', 'ğŸª Store', 'ğŸ¬ Mall', 'ğŸŸï¸ Bank', 'ğŸ¯ Castle'] }">
    <label>
      â›ï¸ Mine
      <small>Click on the button to get coins.</small>
      <button @click.prevent="coins++">Become rich!</button>
    </label>
    <label>
      ğŸ› ï¸ Build
      <small>Create buildings to generate passive income.</small>
      <select ::.number="build.selected" :disabled="build.progress" @change="build.time = 1 + (build.selected ** 2)">
        <option *for="buildings" :value="$i">{{ $value }}</option>
      </select>
    </label>
    <section *if="build.selected">
      <table class="width">
        <tr>
          <th>ğŸª™/s</th>
          <td>+{{ build.selected }}</td>
        </tr>
        <tr>
          <th>ğŸ•</th>
          <td>{{ build.time }}s</td>
        </tr>
      </table>
      <button *if="!build.progress" @click.prevent="build.progress = 1">Build it!</button>
      <progress *if="build.progress" *refresh="1" :value="build.progress" :max="build.time" *eval="$refresh && (build.progress++ >= build.time && (income += build.selected, built.push(buildings[build.selected]), build.selected = build.progress = 0))"></progress>
    </section>
  </form>
  <div class="flash success">
    <b>You have {{ built.length }} building(s) in your city!</b>
    <br>
    <sub>+ {{ income }} ğŸª™/s</sub>
    <br>
    {{ built.map(building => [...building][0]).join(' ') }}
  </div>
</main>
